{% extends 'base.html.j2' %}

{% block app_content %}
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xs-offset-0 col-sm-offset-0 col-md-offset-0 col-lg-offset-0" >
          <div class="panel panel-info">

            <div class="panel-heading">
              <h3 class="panel-title">{{ user.first_name }} {{ user.last_name }}{% if user.is_barman %} – Barman{% endif %}</h3>
            </div>

            <div class="panel-body">
              <div class="row">
                <div class="col-md-3 col-lg-3 " align="center">
                  <!-- User picture -->
                  <img alt="User picture" src="{{ user.avatar() }}" class="img-rounded img-responsive">
                </div>

                <div class=" col-md-9 col-lg-9 ">
                  <table class="table table-user-information">
                    <tbody>
                      <tr>
                        <td><strong>Username:</strong></td>
                        <td>{{ user.username }}</td>
                      </tr>
                      <tr>
                        <td><strong>Email:</strong></td>
                        <td><a href="mailto:{{ user.email }}">{{ user.email }}</a></td>
                      </tr>
                      <tr>
                        <td><strong>Graduating class:</strong></td>
                        <td>{% if user.grad_class != 0 %}{{ user.grad_class }}{% else %}Extern{% endif %}</td>
                      </tr>
                      <tr>
                        <td><strong>Last drink:</strong></td>
                        <td>{{ moment(user.last_drink).format('LLL') }}</td>
                      </tr>
                      <tr>
                        <td><strong>Balance:</strong></td>
                        <td>
                          <div class="progress">
                            <div class="progress-bar progress-bar-{% if user.balance < 5.0 %}danger{% elif user.balance < 10 %}warning{% else %}success{% endif %} progress-bar-striped active" role="progressbar" aria-valuenow="{{ user.balance }}" aria-valuemin="0" aria-valuemax="50" style="width: {{ user.balance }}%; min-width: 3em; max-width: 100%">
                              {{ user.balance }}€
                            </div>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- User statistics -->
            <div class="container-fluid">
            <div class="panel panel-default" align="left">
              <div class="panel-heading">
                <h4 class="panel-title">Statistics</h4>
              </div>
              <div class="panel-body">
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
              </div>
            </div>
          </div>

            <div class="panel-footer">
              <a data-original-title="Broadcast Message" data-toggle="tooltip" type="button" class="btn btn-sm btn-primary"><i class="glyphicon glyphicon-envelope"></i></a>
              {% if current_user.is_barman %}
              <div class="btn-group">
                <button type="button" class="btn btn-primary btn-sm dropdown-toggle {% if user.balance <= 0 %}disabled{% endif %}" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Pay <span class="glyphicon glyphicon-euro"></span>
                </button>

                <ul class="dropdown-menu dropdown-menu-index">
                  <li><a href="#">Action</a></li>
                  <li><a href="#">Another action</a></li>
                  <li><a href="#">Something else here</a></li>
                  <li role="separator" class="divider"></li>
                  <li><a href="#">Separated link</a></li>
                </ul>
              </div>

              <div class="btn-group">
                <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Top up <span class="glyphicon glyphicon-piggy-bank"></span>
                </button>

                <ul class="dropdown-menu dropdown-menu-index">
                  <form action="{{ url_for('main.top_up', username=user.username) }}" method="post">
                  <div class="input-group top-up-form" style="padding: 4px;">
                    <input type="text" name="amount" class="form-control" placeholder="Amount">
                    <span class="input-group-btn">
                      <button class="btn btn-default" type="submit">Go!</button>
                    </span>
                  </div>
                  </form>
                </ul>
              </div>
              {% endif %}
              <span class="pull-right">
                <a href="{{ url_for('main.edit_profile', username=user.username) }}" data-original-title="Edit this user" data-toggle="tooltip" type="button" class="btn btn-sm btn-warning"><i class="glyphicon glyphicon-edit"></i></a>
                {% if current_user.is_barman %}
                <div class="btn-group">
                  <button type="button" class="btn btn-sm btn-danger dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <span class="glyphicon glyphicon-remove"></span>
                  </button>
                  <ul class="dropdown-menu dropdown-menu-right">
                    <li class="dropdown-header">Delete this user?</li>
                    <li><a href="{{ url_for('main.delete_user', username=user.username) }}">Yes</a></li>
                    <li><a href="#">No</a></li>
                  </ul>
                </div>
                {% endif %}
              </span>
            </div>
          </div>
        </div>
      </div>
{% endblock %}
